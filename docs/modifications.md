# Документация по модификациям приложения Zetara Power BMS Tool

## Закомментированные компоненты

В процессе запуска приложения на симуляторе были внесены следующие изменения:

### 1. Отключение библиотеки StatusBarUtil

**Где:**
- В файле `app/build.gradle` закомментирована зависимость:
  ```kotlin
  // Временно отключено из-за проблем с доступом к JitPack
  // implementation 'com.jaeger.statusbarutil:library:1.5.1'
  ```

- В файле `app/src/main/java/com/zetarapower/monitor/MainActivity.kt` закомментированы:
  ```kotlin
  // Импорт библиотеки
  // import com.jaeger.library.StatusBarUtil
  
  // Использование в методе onCreate()
  // StatusBarUtil.setTransparent(this)
  // if (getString(R.string.dark_mode) == "true") {
  //     StatusBarUtil.setDarkMode(this)
  // } else {
  //     StatusBarUtil.setLightMode(this)
  // }
  ```

**Почему:**
При сборке приложения возникла ошибка при попытке загрузить библиотеку `com.jaeger.statusbarutil:library:1.5.1` из репозитория JitPack:
```
Could not GET 'https://jitpack.io/com/jaeger/statusbarutil/library/1.5.1/library-1.5.1.pom'. 
Received status code 401 from server: Unauthorized
```

### 2. Создание класса-заглушки StatusBarUtil

**Где:**
- Создан файл `app/src/main/java/com/zetarapower/monitor/StatusBarUtil.kt` с заглушкой:
  ```kotlin
  package com.zetarapower.monitor

  import android.app.Activity

  /**
   * Временная заглушка для StatusBarUtil, пока не решена проблема с доступом к JitPack
   */
  object StatusBarUtil {
      fun setTransparent(activity: Activity) {
          // Заглушка
      }

      fun setDarkMode(activity: Activity) {
          // Заглушка
      }

      fun setLightMode(activity: Activity) {
          // Заглушка
      }
  }
  ```

**Почему:**
Чтобы компилятор не выдавал ошибки о неразрешенных ссылках на StatusBarUtil в MainActivity.kt, был создан класс-заглушка с теми же методами, но без реальной функциональности.

## Влияние на приложение

### Что не работает после модификаций

Отключение StatusBarUtil влияет **только на визуальную часть** приложения:

1. **Прозрачность статус-бара** - статус-бар теперь имеет стандартный вид и не интегрирован с дизайном приложения.

2. **Адаптация цвета иконок статус-бара** - приложение не может автоматически менять цвет иконок статус-бара (темные/светлые) в зависимости от настройки `R.string.dark_mode`.

### Что продолжает работать

Основная функциональность приложения работает полностью:
- Bluetooth-сканирование и подключение к устройствам
- Мониторинг данных BMS (Battery Management System)
- Все экраны и переходы между ними
- Все настройки и управление устройствами
- Отображение всех данных и информации

## Технические детали

### Что такое StatusBarUtil

**StatusBarUtil** - это библиотека для Android, которая упрощает настройку и стилизацию статус-бара (верхней панели уведомлений) в приложении. Она позволяет:

1. **Делать статус-бар прозрачным** (`setTransparent`) - чтобы контент приложения мог отображаться под статус-баром, создавая эффект полноэкранного приложения.

2. **Менять цвет текста и иконок в статус-баре** (`setDarkMode` и `setLightMode`):
   - `setDarkMode` - устанавливает темные иконки и текст (для светлого фона)
   - `setLightMode` - устанавливает светлые иконки и текст (для темного фона)

3. **Устанавливать цвет статус-бара** и настраивать его прозрачность.

### Что такое JitPack

**JitPack** - это сервис для публикации и распространения библиотек Java/Android через Maven-репозиторий. Он позволяет:

1. Легко публиковать библиотеки с GitHub, GitLab и других Git-репозиториев
2. Автоматически собирать библиотеки из исходного кода
3. Предоставлять доступ к библиотекам через Maven/Gradle

В нашем случае библиотека StatusBarUtil размещена на JitPack, но возникла проблема с доступом (ошибка 401 Unauthorized).

## Возможные решения проблемы

Для восстановления полной функциональности приложения можно:

1. **Решить проблему с доступом к JitPack**:
   - Проверить сетевое подключение
   - Проверить, требует ли JitPack авторизации для доступа к этой библиотеке
   - Связаться с поддержкой JitPack

2. **Использовать локальную копию библиотеки**:
   - Скачать исходный код библиотеки с GitHub
   - Добавить его в проект как модуль

3. **Использовать альтернативную библиотеку**:
   - Например, `SystemBarTint` или встроенные средства Android для работы со статус-баром

4. **Реализовать необходимую функциональность самостоятельно**:
   - Использовать стандартные API Android для настройки статус-бара:
     ```kotlin
     // Для прозрачного статус-бара
     window.decorView.systemUiVisibility = View.SYSTEM_UI_FLAG_LAYOUT_STABLE or View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN
     window.statusBarColor = Color.TRANSPARENT
     
     // Для темных иконок (Android 6.0+)
     window.decorView.systemUiVisibility = window.decorView.systemUiVisibility or View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR
     ```

## Заключение

Внесенные изменения являются временным решением для запуска приложения на симуляторе. Они не влияют на основную функциональность приложения, а только на визуальный стиль статус-бара. В будущем рекомендуется восстановить использование библиотеки StatusBarUtil или реализовать аналогичную функциональность другими средствами.
